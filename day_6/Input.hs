module Input where
    import Data.List.Split
    import qualified Data.Set as Set

    toTuple :: [String] -> (String, String)
    toTuple (x:y:_) = (x, y)

    flatten :: [[a]] -> [a]         
    flatten xs = (\z n -> foldr (\x y -> foldr z y x) n xs) (:) []

    rawInput = "ZR5)FZS\nWCY)ZB3\nNXV)8ZY\nCMN)CLW\n4XG)8VX\nM8S)4F5\nQWB)7WM\nJG4)VPL\nJG3)ZPC\nVKR)KF7\nWH8)8RS\nCNS)D71\nP3L)6SK\nCXM)HSV\n9JX)D4R\nL25)4ZM\nC97)CNS\n7R9)H6M\nXPT)QVX\nVMQ)9M2\n8C4)8F8\nMFN)WZF\nHP9)PBG\nL36)BH1\nCHP)HP9\nMJ3)783\n48Y)BJM\nR4X)BPZ\nPSY)6FM\nHD5)FJX\nD8M)HLW\n49J)KLD\nLZ4)7BZ\n3LZ)TR5\nNHB)WXK\nDMQ)Y2R\nW8S)GD7\nD71)T11\nGZ5)N75\nCLW)W46\n7XW)C8R\nCS2)QS7\nBTP)2MZ\nH5Y)JCB\nDCX)XK1\nBFZ)B1C\nJCJ)YBJ\n1D4)TSW\nSVG)97P\nLVD)FQN\nFY3)Q6R\n9MD)YLC\n5YN)NJ2\n8RL)13T\n3ZT)4SG\nCJ6)X6D\n1NV)JCJ\n35N)R8N\nVL7)M78\nNJ2)7H8\nJQG)VL7\n3CF)T2M\nNZ5)ZGQ\n7WX)KFR\nYVS)6NH\nZDS)17X\nKZN)VX8\nT6M)FSJ\n11S)3PN\nYDK)G4Y\nN7S)3ZK\n7QN)35N\nMC9)ZDR\n2Z1)LY7\nDWY)WDS\nZV1)PTW\n5R4)PWJ\n8GR)8LH\nWF5)3K5\nJS8)YQQ\n2CD)ZC2\nXSN)NX5\nLY7)382\nGC2)1YF\n8LF)SV1\nNNB)QWB\nBDW)G8N\nWSD)5NN\n2MZ)VBP\nV6L)Z4Y\n7H8)5LZ\nVS4)J1F\nCWL)C27\nV1M)XYQ\nQNZ)G3G\nD4R)NF9\nNNP)JG3\nB37)P5P\nDLX)4KM\nCR8)H7N\nHVQ)193\n3ZM)1QP\n7JX)LJN\nTNW)CYP\n8ZY)9WS\nLTX)51X\nPNQ)NWH\nW16)QV7\nTB1)Y39\nKF7)MZH\nR41)QX1\n1J6)J4T\nBCH)9RF\n1B1)XHX\nYXZ)7P5\n3K7)NSV\nLPL)ZDS\nL9P)83J\nFZR)YX3\nW9N)11P\nCWZ)S21\nMRD)YG4\n22L)NXN\n1JH)S4G\nPXJ)6CF\nB5P)HLG\nPSL)YVS\nQ1T)DLX\n7SQ)37T\nYFK)LCC\nXHC)51C\nPZ5)HT8\nYTP)J73\nH6G)XVV\nGG5)DS7\nKVF)PSL\nN75)SYT\n2Z1)L36\nT54)JGP\nG3G)RBM\n2HV)3SH\nNHF)KNC\nH9T)3CZ\n1M9)G3B\nLK3)PNQ\nXMS)1NV\nLMR)ZZP\nKJD)S1Q\n759)917\nXDS)NBS\n596)RVR\nDJM)T9D\nG5D)JCH\nTZ6)2XK\nKH3)9JX\nNXT)5Q1\n7VV)VW7\nQ48)8GR\nPRV)P59\n3SV)NNN\n6WK)P3L\nT11)2X2\nFST)TVR\n72X)388\nH6M)6HN\nL3V)WXJ\nNXV)C3M\n7WY)VZN\nCVS)7JX\n2KK)DMQ\n49H)XCL\nXRQ)3BX\nS1Q)97G\nBJM)759\n33J)F3Q\nN97)WF5\nPMW)V5C\n3XD)JQG\nBVM)L25\nH5J)2SV\nVV4)NV7\nFCZ)KHK\n1BY)32K\nM4X)DQG\nZS1)NHS\nQV7)42L\nF3Q)GKF\n7LN)S3D\nZWK)VG1\n1Z9)7CR\n335)N12\n628)B34\n9LW)5PJ\n6HZ)ZR5\nXSR)YXL\n6GD)BQR\nFQN)7YX\nTY9)1H7\n8MY)X3B\nR6J)9BR\nS5Z)N7S\nXFR)W8J\n6V7)CG5\n4YF)HHQ\n4GX)WG4\n6WH)7KG\n5MK)V1G\nB1C)WWN\n8M2)9V4\nJJ2)9LW\n5JR)GKD\n54F)LYP\n7KG)9FK\nDQB)WMJ\nQ7Q)9VM\nTJW)C14\n5YN)CCQ\nHDY)WCP\nG1S)YDK\nBH1)VC4\nDJS)CFP\nTHJ)2TQ\n6PN)1M9\n783)XLZ\nCZQ)87X\n759)W9N\nHLW)ZZX\nTHD)DHX\nVW7)G7J\n7MN)K2B\nHKW)PSK\nYXC)H6G\nNCM)5MK\nT49)PZF\n1D1)335\n1V6)6HZ\n46W)544\nGGC)Q7Q\nNKZ)HMF\nG3B)CH4\nX9B)J79\n9RF)X1T\nS4G)7WX\n4Y7)4K6\nWWN)4R7\n8XC)7DW\n9FP)2LK\n7VV)W6Z\nHRR)7SQ\n6HP)CMN\n32K)V8W\n69S)XSR\nHS6)6JW\n22Q)2HV\nPTC)3C6\nJF5)5R4\nJCH)L65\nTNW)QJJ\n91D)45B\nRJ5)8LF\n4D9)983\nHRS)PSY\nMT5)T1T\n5PJ)S48\nFSJ)7HW\nSMQ)P2Y\nKNC)46W\nHMF)9FP\n9V4)3DX\nP5P)YWH\n7BZ)1P4\nX3B)JF5\nFHJ)KBG\nRZW)PLS\nW16)25D\nZ54)TNW\n8YP)B29\nDRP)NHQ\nXDS)X65\nJ7Z)VHZ\nM2R)1BY\n4XG)F18\nJYZ)P5X\n5Q1)HKW\nTZ3)G2Y\n19S)GZ5\nJW5)MT5\nPWT)RCJ\nZXC)DQB\nRSN)T35\nVSB)HSD\nNV7)CN4\nX86)G1S\nBKC)22Q\n8F8)F6K\nNTW)NNP\nPB2)J8M\nG4S)Y4F\nTHS)Q2T\nXKV)N3T\n7RN)MFN\nRLT)L97\nY4P)P36\nSGM)DWY\nFX7)RJ5\n9VM)49J\n72D)8V2\nHNC)GG3\nRVR)6Y4\n8V2)K6N\nTV7)BSC\nNBS)JJJ\nCOM)28P\nQSY)MRM\nLVN)X3M\nWNH)DHT\nR16)DJM\nRBM)YXY\nQJJ)VPY\nZB8)B8G\nJ79)HDY\nNTS)G4S\n9FK)NRC\nTSW)HFM\nDS7)BX1\nJGP)CJ4\n17X)XY6\n7DW)4WR\n7SQ)3FP\nWZH)2Z1\nTN8)CJ6\nXRJ)22L\nH5T)KTW\nXMJ)ZC3\nH4X)WL3\nYG4)92F\nB29)Y7B\nKVG)DPN\nQ8G)TQR\nHLG)H5T\nY5B)T54\nS3Y)7WY\nW9G)PTR\nYWH)QSY\n5KW)5W7\nWDS)PWT\n1YS)DB5\n6YB)HNM\nGLS)RSN\nH8D)XWM\nFFV)3ZM\nF8M)XMJ\n13T)W9G\nXS6)6YB\nF18)5LH\nWXK)VMQ\nJZ7)TBG\nY92)SJ4\nP2Y)GC2\nMF9)TT6\nNHS)XWK\nKHK)6WK\nTT6)T6M\n8LH)9K8\nY39)91C\nT63)BKC\n465)7LV\nHWP)4XG\nX6D)HTH\nN3T)ZKN\nFSK)QF4\nCW3)BDF\n9QB)TV7\nYNP)Q1T\nSML)V3G\nNLQ)46H\nJS8)D1Z\nL4L)QF6\nS2T)LMR\n3D2)VSB\nGHB)F29\nWRD)FB3\nNLQ)N8N\nHBL)S5T\n6HN)8Y2\n6SY)7RL\n4YF)JL4\n638)NKZ\nVG1)4R4\nM4N)77J\n959)2LZ\nJ1F)D7L\nMFP)6V7\nLWB)WH8\n6Y6)19S\n5W7)HWL\n9L1)HG4\n5WY)YJ9\n5NN)GNX\n6NH)QCH\nY5M)QNZ\nMJD)Q48\nZ4Q)BTP\nWZF)71T\nGSF)NXT\nN12)QL8\nTTQ)Y7F\n1NV)7RN\nHSD)YY3\nXY6)8XT\nCT5)BMW\nGB3)L5Z\nKL2)TJW\nH7N)HHC\nLCG)Y4P\nYWJ)ZWK\nZXC)KH7\nQCH)SLZ\n4R4)45G\n544)YYZ\nTR5)1Z9\n1P4)X5Z\n6FM)B2T\n1T2)GF8\nF29)YKX\nP92)M4X\nK6N)JS8\n3G8)7R9\nKFR)V2T\n45G)9JP\nQF4)SZ6\nYXY)GLS\nVR3)PCQ\nWV9)6WX\n8G7)N97\nQ5B)DCX\nXYQ)K8V\n2X2)PL4\nFVP)9BK\nPZG)VCP\n1Q2)9NK\nZDR)R8T\nC5G)8M2\n7LV)HBN\nMH7)G98\nKFR)P99\nJ53)HJS\nK8S)DX5\nHHR)T8B\nVLW)PWV\nJJJ)1B9\nCH1)1Q2\nBPZ)YNP\n9QB)DJ2\nRZW)RLT\nSZY)H53\nGRP)1TC\nVPY)THL\n7WX)X83\n8Y2)N6F\n5NM)1J1\nYY3)1DY\n88S)615\nW1C)R9D\nFKN)FY3\n5CX)LKB\nP99)WLZ\nRBN)T5K\nPB2)VR3\nTZ6)MF9\nBXH)X9B\n5TN)FVQ\n5LZ)KJD\nXN5)1HS\nH5Y)R4X\n37T)WMZ\nLRY)HQH\nPWJ)XKV\n2LK)SG5\nJCB)BJW\n1B9)CWL\nFWB)7QN\n58G)CS2\nHT8)XT9\nB65)MV5\n7FD)TZ3\n42L)H3G\nB62)S3P\nBZ3)BDM\nVCP)C7W\n94F)V54\nJBK)KL2\nYKX)Y92\nYQX)HHR\n1H7)SXM\n1ZF)YQX\n388)6KK\nM78)DQV\n1J5)JGL\n41N)6GS\nLCC)FC8\nMRM)XFL\nV7Z)94F\nJQG)2BF\nW5K)TN8\nCS2)91D\n635)QZZ\n5LH)HDB\nXHX)XQV\nX36)Y5B\nCG5)3LQ\nV3G)WV9\nSMN)FZR\n2SV)NMJ\nF92)1B1\nNHQ)6SY\nBDM)HQ2\n1K7)F77\nQZZ)SYG\nYXD)JW1\n11P)7MN\n6KK)VV4\nVNM)3SV\nLX2)WL4\nGG3)54Y\nWVF)DDH\n1TC)HQ9\n886)SML\nXMN)TFK\nLKB)WLS\nZKN)SWR\nVPL)SKH\nFBB)KVG\nP5X)S4Z\nH51)5NM\nBFQ)H9T\nQKL)1T2\nY7F)B2B\nW9D)1CL\nHQH)TTQ\nFQB)SNJ\n77J)RYM\n917)1N2\nR8T)HD5\nVS4)959\nK6F)W3H\n7CR)YPQ\nN27)YXZ\n617)7XW\nSYG)M5J\n9XD)THD\nYQQ)W5K\nPRM)635\nKLX)DZQ\n784)P92\n1TN)QJ1\nTHL)KWP\nSXM)BZ3\n193)839\nFC8)GSF\nDJM)R6J\nVJX)NJY\nPSK)4NC\nHHC)MQ5\n5CB)XHC\nPLZ)S5Z\n6SK)88V\nZPR)LWB\n83J)B65\nJ8M)QM5\nGTY)SAN\nFBN)F96\nCPF)D3V\nK82)LCG\nYPQ)X6M\nKLD)1B3\n4HT)HRS\nFZS)49S\nS45)8XC\n3CZ)YNV\nL73)1D1\n9KX)TDD\nP7J)LSS\n4QQ)RZ2\nR9D)Z47\n3PN)XRJ\nV1G)Y9R\n6Y4)P7J\nJWV)2S2\n7RL)465\nCZV)4YF\n21K)FQB\nPCQ)W16\nTQR)8HS\nW6Z)195\nKVG)S2C\nQ81)Z4Q\n23P)NF8\nJRD)GTV\nZ54)F8M\nKFC)M4N\nD3Q)TBB\n1H1)1TN\n6N6)L9P\n87X)HSS\nXWK)M5Q\nR8N)K6F\nZZP)8GX\nJ7Z)KNV\nPL4)3CF\nZY4)KVF\nFB3)8RL\nL2S)54F\nLT2)LVD\nFVQ)1J5\nHSS)S2T\nY6N)T4C\n72D)THJ\n4K6)XZJ\nDHX)FCZ\nRV4)YFK\n4NC)ZF2\n6WX)KTC\nWLZ)6Y6\nSZ6)5CB\nQF6)RBN\n839)7CJ\nK2Y)DVL\nRZ2)BFZ\n1HS)JZ7\nHSV)WCM\nMS8)V1M\nJL4)S3Y\nKWP)88S\nT1T)4HT\nXDB)TB1\nSN1)4QQ\n2TQ)YS6\nR6J)K8S\nBX1)TDL\nG3F)784\nSLZ)4W9\nX65)6WJ\nWC4)72X\nYPQ)SGM\nT54)TF4\nDQV)THS\nNNB)JWV\nCN4)XSN\n1TC)C2F\nHJS)ZPR\nPWV)LPL\nXR3)Y3R\n59R)926\nKH7)FY7\nTDD)Z6D\n195)628\nKHK)WCY\n9QZ)B37\nQ2T)BP1\nBSC)1JH\nW46)RZN\nFZH)GG5\n4SR)6NR\n983)9QZ\n7YX)68C\nNPF)CHP\nJX7)Z2Y\nG7J)49H\n4KM)YXD\nDJ9)6PN\nMV5)FST\n8GR)4D9\nZB3)K7Y\nT4C)MF5\nNMJ)WZH\nKH7)J53\nH53)JW3\nCYP)WRD\nYYZ)9XD\nRMG)W1C\nPXM)JG4\n6Q7)FSK\nL2S)DJS\nDPN)V5K\n8VX)2PZ\n4SG)BFQ\nHQ2)ZQ3\n382)VJX\nVC4)FR7\nFR7)YDQ\n3LQ)T49\nYY3)7ZK\n6NR)Q5B\nVY1)KZN\nYX3)1YS\nLJQ)D8M\n615)69S\nSG5)3K7\n1B3)BQ7\nXRJ)6GD\nDDH)XRQ\nD5S)QM1\nQX1)CT5\nLYP)6HP\nWLS)WSR\nSJS)46J\nF6K)8G7\nYXL)JJ2\nGMP)CVS\n4R7)RZV\n544)617\nQL8)LFC\nWSR)NHB\nV8W)ZNG\n97P)LK3\nT1T)FM6\nXLZ)BNV\nFST)21K\nQM5)ZGN\nMQ5)W2T\nXK1)W9D\nQS7)FHJ\nG4Y)MLQ\n6CF)VQX\n8VX)KH3\nBMW)VYR\nVW7)TQX\nN8N)6Q7\nZ6D)V6L\n9K8)81T\nVMQ)TY9\nPTW)HN4\nPNV)K2Y\nTF4)1D4\n2S2)59W\nYS6)58G\nNWH)W4J\nHBN)3XD\nQ15)NHF\nB2B)3VG\nVX8)HWP\nVBP)FBB\nPLS)H5J\n1N2)CXM\nDX5)V7Z\nTY9)J7Z\nLZ4)PLZ\nJM9)HNC\nHG4)4Y7\nCFP)5JR\nBDF)XPT\nFQN)K62\nM5L)K82\nTBG)2LX\n2S2)X36\n4QQ)Z54\n926)CR8\nW4J)6N6\n71T)G9J\nSNJ)DJ9\nS2C)LTX\nJG3)8CG\n1QP)PMW\nFM6)SMN\nF96)LVN\nZD3)FR9\n91C)P69\nHHQ)YMG\nWXR)L3V\nXVV)PZG\n25D)JW4\nS4Z)WC4\nNF9)BDW\nFJX)861\nVQX)H8D\nK8V)33J\nZ4Y)L4L\nM5J)M9K\nD71)947\nC5L)MC9\nMF5)YOU\nSX5)WSD\nWCM)M5L\nLDD)HVQ\nYLC)VF8\nHN4)MM5\nT35)GB3\nMS8)7VV\nZPC)9L1\nRJ5)H51\nX83)6MX\nSYG)CH1\nHBP)HP1\nLFC)KGW\nXCL)9KX\nVYM)2CK\n6GS)VLW\nQJ1)3D2\nLJN)1J6\nDJ2)26J\n1J1)KLX\n12H)RMG\n3ZK)5YN\n59W)9Y8\n51X)XR3\n3SH)5KW\nWMZ)DH3\nMPS)NZ5\nP96)ZB8\nBLD)HBL\nB34)NTS\nDH3)PTC\nSWR)VY1\nN8N)JW5\nG8N)23P\nL5Z)FZH\n2BF)F92\nSJ4)MJ3\nJJT)7JK\nZC3)3G8\n7P5)8C4\nV1N)YXC\n1CL)HRR\nV5K)FWB\nP36)HS6\nW52)SJS\n88V)W52\nX5Z)5M6\nBQ7)2JR\nMZH)ZD3\nQ6R)L7K\nMJ5)SGR\nNLR)YTP\nZNG)BLD\n2PZ)R41\nC9X)LZ4\n1DY)B62\nJ4T)SVG\nGQP)CZQ\n5M6)BCH\n1D1)1H1\nZ47)684\nWXJ)DK7\nP4B)SQQ\n68C)W8S\n4WR)XN5\nVF8)9HD\nGD7)MH7\nW2T)L73\nS48)JRD\nS3D)T63\nV5C)SL5\nC7W)BRH\nK9Z)C97\n6NH)12N\nBRH)L2S\nGD5)RG7\nG5V)PRM\nLVD)G5D\nRG7)5CX\nJW3)9MD\nCJ4)FX7\nPZF)M8S\n7JK)MJ5\nKTW)LRY\nXWK)MFP\nC2F)4GX\nD1Z)R16\n1RQ)NPF\nW5F)596\n9Y8)H5Y\n6NW)11S\n1P1)G5V\nD4R)PB2\nBNV)GD5\n8XT)6H7\nFKQ)NCM\nQS7)M2R\nNSV)4GQ\nTQX)JT3\nHP1)VS4\nHQ9)XMN\nF77)ZS1\nM3X)PXJ\nZGN)7C4\nTVR)JJT\nYMG)C5G\nNX5)CW3\nRCJ)2KK\n8VZ)1V6\nDX5)GRP\n9HD)1RQ\nHXW)41N\nY9R)PZ5\n2XK)MQJ\nQF4)JH2\nWG4)VNM\nVHZ)RZQ\nSGR)FKQ\nSQQ)Y6N\nDHT)GHB\n4PV)QKL\nGTV)NNB\nCH4)1NT\n3BX)JBK\nRYM)FBN\nVZN)S8D\nSV1)KZP\nTHF)45S\n4ZM)CWZ\nT5K)5MR\n26J)2CD\nCXM)886\nDQV)RQR\nG2Y)NLQ\nKNV)C9X\n97G)THF\n45B)NXV\n9NK)DRP\nXMS)TZJ\n7C4)NLR\n7HW)W5F\nKZP)4PV\nHT8)638\n3CF)LT2\nZY4)Q8G\n3DX)K24\nBQR)TJV\n46H)FVP\nP69)MPS\n6MX)FF4\nDY5)XDB\n7RL)LKK\nL97)BVM\n2JR)Y5M\nTFK)FFV\nW8J)G3F\nP59)26Y\n596)N27\n8CG)8DL\nXT9)4SR\nM5Q)6WH\nKBG)GMP\nCCQ)8YP\n9BK)CPF\nHNM)353\n3C6)ZXC\nS8D)GTY\n49S)5VJ\n8GX)GGC\nS3P)PXM\nNXT)PNV\nYBJ)YWJ\n4PW)6NW\nD7L)MRD\nT9D)D3Q\n2LX)7FD\nX3M)V1N\nK62)1P1\n8HS)47M\nTDD)JM9\nHDB)BXH\nMLQ)5TN\n3VG)SZY\nFY7)SMQ\nYDQ)D5S\nC3M)3ZT\nN7S)HSZ\nHTH)P96\nWL4)5WY\n28P)9QB\nNJY)C5L\nV54)VYM\n3XD)XFR\nNF8)LJQ\n4W9)K9Z\nRZQ)XDS\nTJV)TZ6\nZGQ)72D\nJT3)XS6\nP92)WVF\nSJ4)SN1\n6H7)P4B\n3K5)PRV\n2CK)XMS\n861)CZV\nH3G)1ZF\nR16)GQP\n51C)4G6\nV2T)1PS\nL7K)WNH\nHFM)VKR\nY4F)Q81\nP4V)FKN\nMM5)8MY\n92F)H4X\n7WM)3LZ\n684)KFC\nD3V)RV4\n2T9)1K7\nYJ9)TQL\nB8G)HBP\nDVL)ZV1\n47M)XNZ\nFF4)LDD\nJW1)5BR\nGKD)RZW\n45S)Q15\nL65)JX7\n4F5)ZY4\nSLZ)X86\n1H1)JYZ\nGF8)B5P\nQVX)2T9\nBP1)7LN\nY3R)P4V\nWCP)8VZ\nGB3)S45\nZC2)59R\n1T2)HXW\nFSJ)NTW\nCH4)M3X\nTBB)SX5\nJW4)MS8\nGRP)LX2\n3FP)12H\nFY3)48Y\n12N)DY5\n9BR)MJD\nKNC)WXR\n6MX)4PW"
    pairs = (map toTuple) . (map (splitOn ")")) . (splitOn "\n") $ rawInput
    waypoints = (Set.toList) . (Set.fromList) . (flatten) . (map (splitOn ")")) . (splitOn "\n") $ rawInput